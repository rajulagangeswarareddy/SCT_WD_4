<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tic-Tac-Toe</title>
<style>
  :root{
    --bg:#0f172a;        /* slate-900 */
    --panel:#111827;     /* gray-900 */
    --muted:#94a3b8;     /* slate-400 */
    --accent:#22d3ee;    /* cyan-400 */
    --win:#10b981;       /* emerald-500 */
    --lose:#ef4444;      /* red-500 */
    --draw:#f59e0b;      /* amber-500 */
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    min-height:100svh;
    display:grid;
    place-items:center;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
    background:
      radial-gradient(1200px 600px at 0% 0%, rgba(34,211,238,.15), transparent 60%),
      radial-gradient(1000px 500px at 100% 100%, rgba(16,185,129,.15), transparent 60%),
      var(--bg);
    color:white;
  }
  .card{
    width:min(94vw,820px);
    background:linear-gradient(180deg, rgba(255,255,255,.06), transparent 30%) , var(--panel);
    border:1px solid rgba(255,255,255,.08);
    border-radius:22px;
    padding:22px;
    box-shadow:0 10px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.05);
  }
  header{
    display:flex; gap:16px; align-items:center; justify-content:space-between; flex-wrap:wrap;
    margin-bottom:18px;
  }
  h1{font-size:clamp(18px,3.2vw,28px); margin:0; letter-spacing:.4px}
  .controls{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
  select,button{
    background:#0b1220;
    color:white;
    border:1px solid rgba(255,255,255,.12);
    border-radius:12px;
    padding:10px 14px;
    font-size:14px;
    cursor:pointer;
    transition:.2s transform, .2s opacity, .2s border-color, .2s background;
  }
  button:hover, select:hover{border-color:rgba(255,255,255,.25)}
  button:active{transform:scale(.98)}
  .score{
    display:flex; gap:12px; flex-wrap:wrap; color:var(--muted); font-weight:600
  }
  .score span{background:#0b1220; padding:8px 12px; border-radius:999px; border:1px solid rgba(255,255,255,.08)}
  .board{
    width:min(92vw,520px);
    margin:18px auto 8px;
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:12px;
  }
  .cell{
    aspect-ratio:1/1;
    display:grid; place-items:center;
    font-size:clamp(34px,10vw,64px);
    font-weight:800;
    background:#0b1220;
    border:1px solid rgba(255,255,255,.08);
    border-radius:18px;
    user-select:none;
    cursor:pointer;
    transition:.18s transform, .18s background, .18s border-color, .18s color, .18s box-shadow;
  }
  .cell:hover{border-color:rgba(255,255,255,.22)}
  .cell.disabled{cursor:not-allowed; opacity:.7}
  .cell.X{color:var(--accent); text-shadow:0 0 14px rgba(34,211,238,.35)}
  .cell.O{color:#60a5fa; text-shadow:0 0 14px rgba(96,165,250,.35)}
  .cell.win{background:rgba(16,185,129,.12); border-color:var(--win); box-shadow:0 0 0 2px rgba(16,185,129,.25) inset}
  .status{
    text-align:center; margin:10px 0 16px; font-weight:700; letter-spacing:.3px
  }
  .status .tag{
    padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.15);
    background:#0b1220; color:#e5e7eb; font-size:13px; display:inline-block
  }
  .status .tag.win{color:var(--win); border-color:rgba(16,185,129,.45)}
  .status .tag.lose{color:var(--lose); border-color:rgba(239,68,68,.45)}
  .status .tag.draw{color:var(--draw); border-color:rgba(245,158,11,.45)}
  footer{display:flex; justify-content:center; gap:10px; margin-top:8px}
</style>
</head>
<body>
  <main class="card">
    <header>
      <h1>Tic-Tac-Toe</h1>
      <div class="controls">
        <select id="mode">
          <option value="pvp">2 Players</option>
          <option value="cpu-easy">Vs Computer — Easy</option>
          <option value="cpu-hard">Vs Computer — Hard (Unbeatable)</option>
        </select>
        <button id="resetBtn">Reset</button>
      </div>
      <div class="score" id="score">
        <span id="xScore">X: 0</span>
        <span id="oScore">O: 0</span>
        <span id="dScore">Draws: 0</span>
      </div>
    </header>

    <section class="board" id="board" aria-label="Tic Tac Toe Board"></section>
    <div class="status" id="status"><span class="tag">X to move</span></div>

    <footer>
      <small style="color:var(--muted)">Tip: change “Mode” any time — Reset starts a fresh game.</small>
    </footer>
  </main>

<script>
(() => {
  const boardEl = document.getElementById('board');
  const statusEl = document.getElementById('status');
  const modeEl = document.getElementById('mode');
  const resetBtn = document.getElementById('resetBtn');
  const xScoreEl = document.getElementById('xScore');
  const oScoreEl = document.getElementById('oScore');
  const dScoreEl = document.getElementById('dScore');

  // --- Game State ---
  let board = Array(9).fill('');
  let current = 'X';
  let gameOver = false;
  let scores = { X:0, O:0, D:0 };

  // Winning triplets
  const LINES = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];

  // Build cells
  for (let i=0;i<9;i++){
    const cell = document.createElement('button');
    cell.className = 'cell';
    cell.setAttribute('data-idx', i);
    cell.setAttribute('aria-label', `Cell ${i+1}`);
    cell.addEventListener('click', () => handleHumanMove(i));
    boardEl.appendChild(cell);
  }

  function setStatus(text, kind=''){
    statusEl.innerHTML = `<span class="tag ${kind}">${text}</span>`;
  }

  function render(){
    [...boardEl.children].forEach((c,i) => {
      c.textContent = board[i];
      c.classList.toggle('X', board[i]==='X');
      c.classList.toggle('O', board[i]==='O');
      c.classList.toggle('disabled', !!board[i] || gameOver);
      c.classList.remove('win');
    });
    xScoreEl.textContent = `X: ${scores.X}`;
    oScoreEl.textContent = `O: ${scores.O}`;
    dScoreEl.textContent = `Draws: ${scores.D}`;
    if(!gameOver) setStatus(`${current} to move`);
  }

  function winner(b){
    for(const [a,b1,c] of LINES){
      if (b[a] && b[a]===b[b1] && b[a]===b[c]) return [b[a],[a,b1,c]];
    }
    if (b.every(v=>v)) return ['D', null]; // draw
    return [null, null];
  }

  function endGame(result, line){
    gameOver = true;
    if (line) line.forEach(i => boardEl.children[i].classList.add('win'));
    if (result==='D'){
      scores.D++; setStatus('Draw', 'draw');
    } else {
      scores[result]++; 
      const kind = (isCpuMode() && result===cpuSide()) ? 'lose' : 'win';
      setStatus(`${result} wins`, kind);
    }
    render();
  }

  function handleHumanMove(i){
    if (gameOver || board[i]) return;
    board[i] = current;
    const [res, line] = winner(board);
    if (res){ endGame(res, line); return; }
    current = other(current);
    render();

    if (isCpuTurn()) {
      // brief delay for UX
      setTimeout(cpuMove, 300);
    }
  }

  function other(p){ return p === 'X' ? 'O' : 'X'; }
  function isCpuMode(){ return modeEl.value.startsWith('cpu'); }
  function cpuSide(){ return 'O'; } // Human always X; CPU is O
  function isCpuTurn(){ return isCpuMode() && current === cpuSide() && !gameOver; }

  // --- CPU Logic ---
  function cpuMove(){
    if (modeEl.value === 'cpu-easy'){
      easyMove();
    } else {
      unbeatableMove();
    }
  }

  function easyMove(){
    const empty = board.map((v,i)=>v?null:i).filter(v=>v!==null);
    const pick = empty[Math.floor(Math.random()*empty.length)];
    board[pick] = cpuSide();
    const [res,line] = winner(board);
    if (res) { endGame(res,line); return; }
    current = other(current);
    render();
  }

  // Minimax with small optimizations (since board is tiny)
  function unbeatableMove(){
    const best = minimax(board, cpuSide(), -Infinity, Infinity);
    board[best.index] = cpuSide();
    const [res,line] = winner(board);
    if (res) { endGame(res,line); return; }
    current = other(current);
    render();
  }

  function minimax(b, player, alpha, beta){
    const [res] = winner(b);
    if (res === cpuSide()) return {score: +10};
    if (res === other(cpuSide())) return {score: -10};
    if (res === 'D') return {score: 0};

    const moves = [];
    for (let i=0;i<9;i++){
      if (!b[i]){
        b[i] = player;
        const next = minimax(b, other(player), alpha, beta);
        moves.push({ index:i, score: next.score });
        b[i] = '';
        if (player === cpuSide()){
          alpha = Math.max(alpha, next.score);
          if (beta <= alpha) break; // prune
        } else {
          beta = Math.min(beta, next.score);
          if (beta <= alpha) break;
        }
      }
    }

    // Pick best for current player
    if (player === cpuSide()){
      return moves.reduce((a,m)=> m.score>a.score?m:a, {score:-Infinity, index:moves[0]?.index});
    } else {
      return moves.reduce((a,m)=> m.score<a.score?m:a, {score:+Infinity, index:moves[0]?.index});
    }
  }

  // --- Reset / Mode change ---
  function reset(newStarting='X'){
    board = Array(9).fill('');
    current = newStarting;
    gameOver = false;
    render();
    if (isCpuTurn()) setTimeout(cpuMove, 250);
  }

  resetBtn.addEventListener('click', ()=> reset('X'));
  modeEl.addEventListener('change', ()=> reset('X'));

  // init
  render();
})();
</script>
</body>
</html>
